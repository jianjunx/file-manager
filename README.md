# æ–‡ä»¶ç®¡ç†å™¨

ä¸€ä¸ªåŸºäº Fresh æ¡†æ¶æ„å»ºçš„ç°ä»£åŒ–æ–‡ä»¶ç®¡ç†å™¨ï¼Œæ”¯æŒæ–‡ä»¶ä¸Šä¼ ã€ä¸‹è½½ã€é‡å‘½åã€ç§»åŠ¨ã€å¤åˆ¶ã€åˆ é™¤ç­‰åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ“ ç›®å½•æµè§ˆå’Œå¯¼èˆª
- ğŸ“¤ æ–‡ä»¶ä¸Šä¼ ï¼ˆæ”¯æŒå¤šæ–‡ä»¶ï¼‰
- ğŸ“¥ æ–‡ä»¶ä¸‹è½½
- âœï¸ æ–‡ä»¶é‡å‘½å
- ğŸ“‹ æ–‡ä»¶å¤åˆ¶
- ğŸ”„ æ–‡ä»¶ç§»åŠ¨
- ğŸ—‘ï¸ æ–‡ä»¶åˆ é™¤
- ğŸ“‚ æ–°å»ºæ–‡ä»¶å¤¹
- ğŸ” é¢åŒ…å±‘å¯¼èˆª
- ğŸ“± å“åº”å¼è®¾è®¡
- ğŸŒ™ æ”¯æŒæš—è‰²æ¨¡å¼
- ğŸ” ç”¨æˆ·èº«ä»½éªŒè¯ï¼ˆå¯é€‰ï¼‰
- ğŸ³ Docker éƒ¨ç½²æ”¯æŒ

## ç¯å¢ƒè¦æ±‚

- Deno 1.45.5+
- æˆ–è€… Docker

## æœ¬åœ°å¼€å‘

1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd file-manager
```

2. ç¡®ä¿ `data` ç›®å½•å­˜åœ¨ï¼ˆå¯é€‰ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºï¼‰
```bash
mkdir -p data
```

3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
deno task start
```

4. è®¿é—® http://localhost:8000

**æ³¨æ„**ï¼šæœ¬åœ°å¼€å‘æ—¶ï¼Œæ–‡ä»¶ç®¡ç†å™¨ä¼šä½¿ç”¨ `./data` ç›®å½•ä½œä¸ºæ ¹ç›®å½•ï¼Œè¿™ä¸Dockeréƒ¨ç½²æ—¶çš„è¡Œä¸ºä¿æŒä¸€è‡´ã€‚

## ç¯å¢ƒå˜é‡é…ç½®

å¯é€‰çš„ç¯å¢ƒå˜é‡ï¼š
- `PORT`: åº”ç”¨è¿è¡Œç«¯å£ï¼ˆé»˜è®¤ä¸º8000ï¼‰
- `AUTH_USERNAME`: èº«ä»½éªŒè¯ç”¨æˆ·åï¼ˆè®¾ç½®åå¯ç”¨èº«ä»½éªŒè¯ï¼‰
- `AUTH_PASSWORD`: èº«ä»½éªŒè¯å¯†ç ï¼ˆè®¾ç½®åå¯ç”¨èº«ä»½éªŒè¯ï¼‰
- `SESSION_SECRET`: Sessionå¯†é’¥ï¼ˆå¯é€‰ï¼Œæœªè®¾ç½®æ—¶è‡ªåŠ¨ç”Ÿæˆï¼‰
- `FILE_MANAGER_ROOT`: æ–‡ä»¶ç®¡ç†å™¨çš„æ ¹ç›®å½•è·¯å¾„ï¼ˆDockeréƒ¨ç½²æ—¶é»˜è®¤ä¸º/dataï¼Œæœ¬åœ°å¼€å‘æ—¶é»˜è®¤ä¸º./dataï¼‰

### èº«ä»½éªŒè¯

æ–‡ä»¶ç®¡ç†å™¨æ”¯æŒå¯é€‰çš„ç”¨æˆ·èº«ä»½éªŒè¯åŠŸèƒ½ï¼š

- **å¯ç”¨èº«ä»½éªŒè¯**: è®¾ç½® `AUTH_USERNAME` å’Œ `AUTH_PASSWORD` ç¯å¢ƒå˜é‡
- **ç¦ç”¨èº«ä»½éªŒè¯**: ä¸è®¾ç½® `AUTH_USERNAME` å’Œ `AUTH_PASSWORD`ï¼Œä»»ä½•äººéƒ½å¯ä»¥è®¿é—®
- **Sessionç®¡ç†**: ç™»å½•åä½¿ç”¨cookieå­˜å‚¨sessionï¼Œé»˜è®¤æœ‰æ•ˆæœŸ7å¤©

ç¤ºä¾‹é…ç½®ï¼š
```bash
# å¯ç”¨èº«ä»½éªŒè¯
export AUTH_USERNAME=admin
export AUTH_PASSWORD=your_secure_password

# å¯é€‰ï¼šè‡ªå®šä¹‰sessionå¯†é’¥
export SESSION_SECRET=your_random_secret_key
```

## Docker éƒ¨ç½²

### ä½¿ç”¨é¢„æ„å»ºé•œåƒï¼ˆæ¨èï¼‰

é¡¹ç›®å·²é…ç½®GitHub Actionsè‡ªåŠ¨æ„å»ºå¤šå¹³å°é•œåƒï¼Œæ”¯æŒamd64å’Œarm64æ¶æ„ï¼š

```bash
# æ‹‰å–æœ€æ–°é•œåƒ
docker pull ghcr.io/your-username/file-manager:latest

# è¿è¡Œå®¹å™¨
docker run -d \
  --name file-manager \
  -p 8000:8000 \
  -v /path/to/your/files:/data \
  ghcr.io/your-username/file-manager:latest

# å¯ç”¨èº«ä»½éªŒè¯
docker run -d \
  --name file-manager \
  -p 8000:8000 \
  -e AUTH_USERNAME=admin \
  -e AUTH_PASSWORD=your_secure_password \
  -v /path/to/your/files:/data \
  ghcr.io/your-username/file-manager:latest
```

### å¿«é€Ÿå¼€å§‹

ä½¿ç”¨æä¾›çš„ç¤ºä¾‹è„šæœ¬å¿«é€Ÿå¯åŠ¨ï¼š
```bash
# è¿è¡Œç¤ºä¾‹ï¼ˆä½¿ç”¨ ./example-data ä½œä¸ºæ•°æ®ç›®å½•ï¼‰
./run-example.sh

# æˆ–è€…æµ‹è¯•éƒ¨ç½²
./test-deployment.sh
```

### ä½¿ç”¨ Docker Composeï¼ˆæ¨èï¼‰

é¡¹ç›®æä¾›ä¸¤ä¸ªDocker Composeé…ç½®æ–‡ä»¶ï¼š

#### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨é¢„æ„å»ºé•œåƒï¼ˆæ¨èï¼‰

ä½¿ç”¨`docker-compose.ghcr.yml`ä»GitHub Container Registryæ‹‰å–é¢„æ„å»ºé•œåƒï¼š

```bash
# 1. åˆ›å»ºæ•°æ®ç›®å½•
mkdir -p ./data

# 2. ä¿®æ”¹docker-compose.ghcr.ymlä¸­çš„GitHubç”¨æˆ·å
# å°† 'your-username' æ›¿æ¢ä¸ºå®é™…çš„GitHubç”¨æˆ·å

# 3. å¯åŠ¨æœåŠ¡
docker-compose -f docker-compose.ghcr.yml up -d
```

#### æ–¹æ¡ˆäºŒï¼šæœ¬åœ°æ„å»º

ä½¿ç”¨`docker-compose.yml`æœ¬åœ°æ„å»ºé•œåƒï¼š

```bash
# 1. åˆ›å»ºæ•°æ®ç›®å½•
mkdir -p ./data

# 2. ä¿®æ”¹ docker-compose.yml ä¸­çš„å·æ˜ å°„ï¼ˆå¯é€‰ï¼‰
# volumes:
#   - /path/to/your/files:/data

# 3. å¯åŠ¨æœåŠ¡
docker-compose up -d
```

### æœ¬åœ°æ„å»º

å¦‚æœæ‚¨éœ€è¦è‡ªè¡Œæ„å»ºé•œåƒï¼š

1. æ„å»ºé•œåƒ
```bash
docker build -t file-manager .
```

2. è¿è¡Œå®¹å™¨
```bash
docker run -d \
  --name file-manager \
  -p 8000:8000 \
  -v /path/to/your/files:/data \
  file-manager
```

### ç¯å¢ƒå˜é‡

Docker éƒ¨ç½²æ—¶å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

- `PORT`: åº”ç”¨ç«¯å£ï¼ˆé»˜è®¤ 8000ï¼‰
- `AUTH_USERNAME`: èº«ä»½éªŒè¯ç”¨æˆ·åï¼ˆå¯é€‰ï¼‰
- `AUTH_PASSWORD`: èº«ä»½éªŒè¯å¯†ç ï¼ˆå¯é€‰ï¼‰
- `SESSION_SECRET`: Sessionå¯†é’¥ï¼ˆå¯é€‰ï¼‰

å®¹å™¨ä¼šè‡ªåŠ¨ä½¿ç”¨ `/data` ç›®å½•ä½œä¸ºæ–‡ä»¶ç®¡ç†å™¨çš„æ ¹ç›®å½•ï¼Œä½ åªéœ€è¦å°†å®¿ä¸»æœºç›®å½•æ˜ å°„åˆ° `/data` å³å¯ã€‚

#### å¯ç”¨èº«ä»½éªŒè¯çš„Dockerå‘½ä»¤ç¤ºä¾‹

```bash
docker run -d \
  --name file-manager \
  -p 8000:8000 \
  -e AUTH_USERNAME=admin \
  -e AUTH_PASSWORD=your_secure_password \
  -v /path/to/your/files:/data \
  file-manager
```

## ä½¿ç”¨è¯´æ˜

1. **æµè§ˆæ–‡ä»¶**: ç‚¹å‡»æ–‡ä»¶å¤¹è¿›å…¥ï¼Œç‚¹å‡» "..." è¿”å›ä¸Šçº§ç›®å½•
2. **ä¸Šä¼ æ–‡ä»¶**: ç‚¹å‡»"ä¸Šä¼ æ–‡ä»¶"æŒ‰é’®é€‰æ‹©æ–‡ä»¶
3. **åˆ›å»ºæ–‡ä»¶å¤¹**: ç‚¹å‡»"æ–°å»ºæ–‡ä»¶å¤¹"æŒ‰é’®
4. **æ–‡ä»¶æ“ä½œ**: é€‰ä¸­æ–‡ä»¶åå¯ä»¥è¿›è¡Œç§»åŠ¨ã€å¤åˆ¶ã€åˆ é™¤æ“ä½œ
5. **å³é”®èœå•**: å³é”®ç‚¹å‡»æ–‡ä»¶å¯ä»¥è¿›è¡Œé‡å‘½åã€ä¸‹è½½ç­‰æ“ä½œ

## å®‰å…¨ç‰¹æ€§

- ğŸ” å¯é€‰çš„ç”¨æˆ·èº«ä»½éªŒè¯
- ğŸ›¡ï¸ è·¯å¾„éå†æ”»å‡»é˜²æŠ¤
- ğŸ”’ æ–‡ä»¶è®¿é—®æƒé™æ§åˆ¶
- ğŸ“‹ å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ å¤„ç†
- âœ… ç”¨æˆ·è¾“å…¥éªŒè¯
- ğŸª å®‰å…¨çš„Sessionç®¡ç†

## æŠ€æœ¯æ ˆ

- [Fresh](https://fresh.deno.dev/) - ç°ä»£åŒ–çš„ Deno Web æ¡†æ¶
- [Deno](https://deno.land/) - å®‰å…¨çš„ JavaScript/TypeScript è¿è¡Œæ—¶
- [Tailwind CSS](https://tailwindcss.com/) - å®ç”¨ç¨‹åºä¼˜å…ˆçš„ CSS æ¡†æ¶
- [Preact](https://preactjs.com/) - è½»é‡çº§çš„ React æ›¿ä»£å“

## CI/CD

é¡¹ç›®é…ç½®äº†GitHub Actionsè‡ªåŠ¨åŒ–æµæ°´çº¿ï¼š

- âœ… è‡ªåŠ¨æ„å»ºå¤šå¹³å°Dockeré•œåƒï¼ˆamd64, arm64ï¼‰
- ğŸ“¦ è‡ªåŠ¨æ¨é€åˆ°GitHub Container Registry
- ğŸ·ï¸ è‡ªåŠ¨æ ‡ç­¾ç®¡ç†ï¼ˆlatest, version tagsï¼‰
- ğŸ”’ å®‰å…¨çš„æ„å»ºæµç¨‹å’Œç­¾åéªŒè¯

æ¯æ¬¡æ¨é€åˆ°mainåˆ†æ”¯æˆ–åˆ›å»ºæ–°çš„ç‰ˆæœ¬æ ‡ç­¾æ—¶ï¼Œéƒ½ä¼šè‡ªåŠ¨è§¦å‘æ„å»ºæµç¨‹ã€‚

## å¼€å‘

### é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ .github/                # GitHubé…ç½®
â”‚   â””â”€â”€ workflows/          # GitHub Actionså·¥ä½œæµ
â”‚       â””â”€â”€ docker-build.yml # å¤šå¹³å°Dockeré•œåƒæ„å»º
â”œâ”€â”€ components/              # å¯é‡ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ Breadcrumb.tsx      # é¢åŒ…å±‘å¯¼èˆª
â”‚   â”œâ”€â”€ ContextMenu.tsx     # å³é”®èœå•
â”‚   â”œâ”€â”€ DirectorySelector.tsx # ç›®å½•é€‰æ‹©å™¨
â”‚   â”œâ”€â”€ FileList.tsx        # æ–‡ä»¶åˆ—è¡¨
â”‚   â”œâ”€â”€ LoginForm.tsx       # ç™»å½•è¡¨å•
â”‚   â””â”€â”€ UploadModal.tsx     # ä¸Šä¼ å¯¹è¯æ¡†
â”œâ”€â”€ islands/                # äº¤äº’ç»„ä»¶
â”‚   â”œâ”€â”€ AuthWrapper.tsx     # èº«ä»½éªŒè¯åŒ…è£…å™¨
â”‚   â””â”€â”€ FileManager.tsx     # æ–‡ä»¶ç®¡ç†å™¨ä¸»ç»„ä»¶
â”œâ”€â”€ routes/                 # è·¯ç”±å’ŒAPI
â”‚   â”œâ”€â”€ api/auth/           # èº«ä»½éªŒè¯API
â”‚   â”‚   â”œâ”€â”€ login.ts        # ç”¨æˆ·ç™»å½•
â”‚   â”‚   â”œâ”€â”€ logout.ts       # ç”¨æˆ·ç™»å‡º
â”‚   â”‚   â””â”€â”€ status.ts       # è®¤è¯çŠ¶æ€
â”‚   â”œâ”€â”€ api/files/          # æ–‡ä»¶ç®¡ç†API
â”‚   â”‚   â”œâ”€â”€ copy.ts         # å¤åˆ¶æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ create-dir.ts   # åˆ›å»ºç›®å½•
â”‚   â”‚   â”œâ”€â”€ delete.ts       # åˆ é™¤æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ download.ts     # ä¸‹è½½æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ list.ts         # åˆ—å‡ºæ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ move.ts         # ç§»åŠ¨æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ rename.ts       # é‡å‘½åæ–‡ä»¶
â”‚   â”‚   â””â”€â”€ upload.ts       # ä¸Šä¼ æ–‡ä»¶
â”‚   â””â”€â”€ index.tsx           # ä¸»é¡µé¢
â”œâ”€â”€ static/                 # é™æ€èµ„æº
â”œâ”€â”€ auth.ts                 # èº«ä»½éªŒè¯å·¥å…·
â”œâ”€â”€ config.ts               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ main.ts                 # åº”ç”¨å…¥å£
â”œâ”€â”€ Dockerfile              # Dockeré…ç½®
â”œâ”€â”€ docker-compose.yml      # Docker Composeé…ç½®ï¼ˆæœ¬åœ°æ„å»ºï¼‰
â”œâ”€â”€ docker-compose.ghcr.yml # Docker Composeé…ç½®ï¼ˆé¢„æ„å»ºé•œåƒï¼‰
â”œâ”€â”€ run-example.sh          # ç¤ºä¾‹å¯åŠ¨è„šæœ¬
â”œâ”€â”€ test-deployment.sh      # éƒ¨ç½²æµ‹è¯•è„šæœ¬
â”œâ”€â”€ env.example             # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ README.md               # è¯´æ˜æ–‡æ¡£
```

### å¼€å‘å‘½ä»¤

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
deno task start

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆç›‘å¬æ–‡ä»¶å˜åŒ–ï¼‰
deno task dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
deno task build

# è¿è¡Œæµ‹è¯•
deno task test
```

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## è®¸å¯è¯

MIT License
